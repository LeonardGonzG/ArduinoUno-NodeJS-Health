<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IoT-Health</title>

    <link rel="stylesheet" type="text/css" href="./dev/css/main.css">
    <script src="./dev/JS/lib/jquery.min.js"></script>

    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="./dev/JS/lib/bootstrap.min.css" rel="stylesheet">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

    <link rel="stylesheet" type="text/css" href="./dev/JS/lib/chart.js/dist/Chart.min.css">

    <link href="https://fonts.googleapis.com/css?family=Montserrat:300,400,600|Open+Sans" rel="stylesheet">

    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css">
    <!--
        <link rel="stylesheet" href="./dev/css/lib/all.css">
-->

</head>

<body>

    <div id="home" class="d-block">
        <video autoplay muted loop id="myVideo">
            <source src="./dev/video/humanBody.mp4" type="video/mp4">
          </video>
        <div class="content">
            <h1>Prototipo de dispositivo para monitoreo de signos vitales de pacientes en zonas de desastres o accidentes
            </h1><br>
            <strong>Autor.</strong> Leonardo Gonzalez Gutierrez <br>
            <strong>Programa.</strong> Ingeniería en Sistemas y Computación <br> Universidad de Caldas <br><br>
            <input id="codDevice" placeholder="Código de dispositivo" type="text">
            <button id="goDevice">Conectar</button>
        </div>
    </div>

    <div class="containerPage d-none" id="containerPage">
        <br><br><br><br><br>
        <div class="d-flex justify-content-center"> <img src="./dev/img/rolling.gif" alt="" srcset=""></div>

        <div class="preloader">
            <p>Conectando...</p>
        </div>
        <div class="d-flex justify-content-center">
            <strong>
                <br><br><br><br><br><br><br><br><br><br>
                <small>Prototipo de dispositivo para monitoreo de signos vitales de pacientes en zonas de desastres o accidentes
</small>

            </strong>
        </div>
        <div class="d-flex justify-content-center">
            <strong>
                <small>Leonardo Gonzalez Gutierrez</small>
            </strong>
        </div>
        <div class="d-flex justify-content-center">
            <strong>
                <small>Cod. 1701716481</small>
            </strong>
        </div>

    </div>

    <div class="containerPageEnd d-none" id="containerPageEnd">
        <br><br><br><br><br>
        <div class="d-flex justify-content-center"> <img src="./dev/img/outpage.gif" height="100px" width="100px"></div>
        <br>
        <div class="preloaderEnd">
            <p>Desconectando...</p>
        </div>
        <div class="d-flex justify-content-center">
            <strong>
                <br><br><br><br><br><br><br><br><br><br>
                <small>Prototipo de dispositivo para monitoreo de signos vitales de pacientes en zonas de desastres o accidentes
                </small>

            </strong>
        </div>
        <div class="d-flex justify-content-center">
            <strong>
                <small>Leonardo Gonzalez Gutierrez</small>
            </strong>
        </div>
        <div class="d-flex justify-content-center">
            <strong>
                <small>Cod. 1701716481</small>
            </strong>
        </div>
    </div>



    <div id="beforeHome">

        <div id="deviceConected" class="container d-none">
            <nav id="navbarDev" class="navbar-dark bg-primary">
                <div>
                    <a class="navbar-brand"></a>
                </div>
            </nav>
            <div id="appRun" class="alert alert-primary" role="alert">
                <div class="row">
                    <div class="col-5">
                        <small>
                        Estudiante: <strong>Leonardo Gonzalez Gutierrez</strong> <br> Automatización y control del procesos <br> Universidad de Caldas
    
                       </small>

                        <hr class="dashed">
                        <div class="row">
                            <h2>Prototipo de dispositivo para monitoreo de signos vitales de pacientes en zonas de desastres o accidentes
                            </h2>
                            <div class="col">
                                <button style="border-radius: 50%;" type="button" id="offDevice" class="btn btn-warning btn-sm"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-power" viewBox="0 0 16 16">
                                    <path d="M7.5 1v7h1V1h-1z"/>
                                    <path d="M3 8.812a4.999 4.999 0 0 1 2.578-4.375l-.485-.874A6 6 0 1 0 11 3.616l-.501.865A5 5 0 1 1 3 8.812z"/>
                                  </svg></button>
                            </div>
                        </div>
                    </div>

                    <div class="col">
                        <div class="contenedor">

                            <div id="mapa" style="width:300px; height: 200px;">
                                <div class="mesaje">
                                    <img src="./dev/img/location.gif" style="width:300px; height: 200px;" alt="" srcset="">
                                </div>
                            </div>
                            <a class="ubicar"><strong>Encuentra mi ubicación</strong></a>


                        </div>
                    </div>
                    <div class="col">
                        <div id="MyClockDisplay" class="clock" onload="showTime()">oe</div>
                        <span class="material-icons md-48">location_on</span><br>
                        <span class="longitud"></span><br>
                        <span class="latitud"></span><br>

                    </div>
                </div>

            </div>



            <div>
                <div class="row">

                    <div class="col-4 ">

                        <img src="./dev/img/peopleHeartRate.jpg" alt="..." class="img-thumbnail">
                        <br>
                        <br>
                        <div class="d-flex justify-content-center">
                            <button id="btn-abrir-popup" type="button" class="btn-abrir-popup btn btn-danger btn-lg"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-heart-fill" viewBox="0 0 16 16">
                                <path fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314z"/>
                              </svg>&nbsp;&nbsp;Ritmo cardiaco</button>
                        </div>



                    </div>
                    <div class="col-4">
                        <img src="./dev/img/peopleOxigen.png" alt="..." class="img-thumbnail">
                        <br>
                        <br>
                        <div class="d-flex justify-content-center">
                            <button id="btn-abrir-popup-2" type="button" class="btn-abrir-popup btn btn-primary btn-lg">
                                <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-clouds" viewBox="0 0 16 16">
                                    <path d="M16 7.5a2.5 2.5 0 0 1-1.456 2.272 3.513 3.513 0 0 0-.65-.824 1.5 1.5 0 0 0-.789-2.896.5.5 0 0 1-.627-.421 3 3 0 0 0-5.22-1.625 5.587 5.587 0 0 0-1.276.088 4.002 4.002 0 0 1 7.392.91A2.5 2.5 0 0 1 16 7.5z"/>
                                    <path d="M7 5a4.5 4.5 0 0 1 4.473 4h.027a2.5 2.5 0 0 1 0 5H3a3 3 0 0 1-.247-5.99A4.502 4.502 0 0 1 7 5zm3.5 4.5a3.5 3.5 0 0 0-6.89-.873.5.5 0 0 1-.51.375A2 2 0 1 0 3 13h8.5a1.5 1.5 0 1 0-.376-2.953.5.5 0 0 1-.624-.492V9.5z"/>
                                  </svg>
                                &nbsp;&nbsp;Oxigeno</button>
                        </div>
                    </div>
                    <div class="col-4">
                        <img src="./dev/img/peopleTemperature.jpg" alt="..." class="img-thumbnail">
                        <br>
                        <br>
                        <div class="d-flex justify-content-center">
                            <button id="btn-abrir-popup-3" type="button" class="btn-abrir-popup btn btn-info btn-lg">
                                <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-thermometer-half" viewBox="0 0 16 16">
                                    <path d="M9.5 12.5a1.5 1.5 0 1 1-2-1.415V6.5a.5.5 0 0 1 1 0v4.585a1.5 1.5 0 0 1 1 1.415z"/>
                                    <path d="M5.5 2.5a2.5 2.5 0 0 1 5 0v7.55a3.5 3.5 0 1 1-5 0V2.5zM8 1a1.5 1.5 0 0 0-1.5 1.5v7.987l-.167.15a2.5 2.5 0 1 0 3.333 0l-.166-.15V2.5A1.5 1.5 0 0 0 8 1z"/>
                                  </svg>
                                &nbsp;&nbsp;Temperatura</button>
                        </div>

                    </div>

                </div>



                <div class="overlay" id="overlay">
                    <div class="popup" id="popup">
                        <a href="#" id="btn-cerrar-popup" class="btn-cerrar-popup"><i class="fas fa-times"></i></a>
                        <!--  Información de ritmo cardiaco-->
                        <div id="dataHeartRate" class="d-none">
                            <!-- d-block -->
                            <h3><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-heart-fill" viewBox="0 0 16 16">
                                <path fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314z"/>
                              </svg>&nbsp;&nbsp;RITMO CARDIACO</h3>
                            <h4>Sensor MAX30100 PulseOximeter</h4>
                            <div class="row">
                                <div class="col-3">
                                    <br><br>
                                    <div class="alert alert-warning" style="min-width: 310px; max-width: 310px; height: 80px; margin: 0 auto">
                                        <h1 id="showDataRitmoCard">81 <small>bpm</small> </h1>
                                    </div>

                                    <div id="container" style="min-width: 310px; max-width: 400px; height: 300px; margin: 0 auto"></div>
                                </div>
                                <div class="col-9">
                                    <canvas id="myCanvas" style="width:800px; height: 350px;"></canvas>
                                </div>
                            </div>
                        </div>

                        <div id="dataOxygen" class="d-none">
                            <h3> <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-clouds" viewBox="0 0 16 16">
                                <path d="M16 7.5a2.5 2.5 0 0 1-1.456 2.272 3.513 3.513 0 0 0-.65-.824 1.5 1.5 0 0 0-.789-2.896.5.5 0 0 1-.627-.421 3 3 0 0 0-5.22-1.625 5.587 5.587 0 0 0-1.276.088 4.002 4.002 0 0 1 7.392.91A2.5 2.5 0 0 1 16 7.5z"/>
                                <path d="M7 5a4.5 4.5 0 0 1 4.473 4h.027a2.5 2.5 0 0 1 0 5H3a3 3 0 0 1-.247-5.99A4.502 4.502 0 0 1 7 5zm3.5 4.5a3.5 3.5 0 0 0-6.89-.873.5.5 0 0 1-.51.375A2 2 0 1 0 3 13h8.5a1.5 1.5 0 1 0-.376-2.953.5.5 0 0 1-.624-.492V9.5z"/>
                              </svg>&nbsp;&nbsp;Saturación de oxigeno</h3>
                            <h4>Sensor MAX30100 PulseOximeter</h4>


                            <div class="row">
                                <div class="col-3">
                                    <br><br>

                                    <div class="alert alert-warning" style="min-width: 310px; max-width: 310px; height: 80px; margin: 0 auto">
                                        <h1 id="showDataSaturacion">98% <small>SpO2</small> </h1>
                                    </div>
                                    <div id="containerOxigeno" style="min-width: 310px; max-width: 400px; height: 300px; margin: 0 auto"></div>

                                </div>
                                <div class="col-9">
                                    <canvas id="canvas02"></canvas>
                                </div>
                            </div>

                        </div>


                        <div id="dataTemperature" class="d-none">
                            <h3> <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-thermometer-half" viewBox="0 0 16 16">
                                <path d="M9.5 12.5a1.5 1.5 0 1 1-2-1.415V6.5a.5.5 0 0 1 1 0v4.585a1.5 1.5 0 0 1 1 1.415z"/>
                                <path d="M5.5 2.5a2.5 2.5 0 0 1 5 0v7.55a3.5 3.5 0 1 1-5 0V2.5zM8 1a1.5 1.5 0 0 0-1.5 1.5v7.987l-.167.15a2.5 2.5 0 1 0 3.333 0l-.166-.15V2.5A1.5 1.5 0 0 0 8 1z"/>
                              </svg>&nbsp;&nbsp;TEMPERATURA CORPORAL Y AMBIENTAL</h3>
                            <h4>Sensor MLX90614</h4>
                            <div class="row">
                                <div class="col-3">
                                    <br><br>
                                    <div id="container-speed" style="min-width: 100px; max-width: 1000px; height: 200px; margin: 0 auto"></div>
                                    <div id="container-rpm" style="min-width: 100x; max-width: 1000px; height: 200px; margin: 0 auto"></div>
                                </div>
                                <div class="col-9">
                                    <canvas id="canvas03"></canvas>
                                </div>
                            </div>

                        </div>

                    </div>
                </div>


                <h3>Información</h3>
                <button id="accordionOne" class="accordion"><strong>Ritmo Cardiaco</strong></button>
                <div class="panelAccordion">
                    <div class="row">
                        <div class="col-4">
                            <br>
                            <p>
                                El pulso es la expansión transitoria de una arteria y constituye un índice de frecuencia y ritmos cardiacos. La frecuencia cardiaca es el número de latidos del corazón por minuto. Por cada latido, se contrae el ventrículo izquierdo y expulsa la sangre
                                al interior de la aorta. Esta expulsión enérgica de la sangre origina una onda que se transmite a la periferia del cuerpo a través de las arterias

                            </p>
                        </div>
                        <div class="col-4">
                            <br>
                            <div class="alert-primary">

                                <p>
                                    Las cifras normales de la frecuencia del pulso en el paciente adulto hombre es de 70 por minuto, y en la mujer adulta es de 80 por minuto <strong>(oscila entre 60 y 80 por minuto).</strong>

                                </p>
                            </div>

                            <strong>Bradicardia:</strong> Disminución de los latidos cardiacos con una frecuencia menor de 60 por minuto. <br>
                            <strong>Taquicardia: </strong>Frecuencia cardiaca superior a los 100 latidos por minuto.

                        </div>
                        <div class="col-4">
                            <br>
                            <iframe width="350" height="250" src="https://www.youtube.com/embed/GMBSU-2GK3E" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                        </div>
                    </div>
                    <sup>https://www.pisa.com.mx/publicidad/portal/enfermeria/manual/4_1_1.htm#:~:text=Los%20signos%20vitales%20son%20par%C3%A1metros,evoluci%C3%B3n%2C%20ya%20sea%20positiva%20o</sup>
                </div>
                <br>
                <button id="accordionTwo" class="accordion"><strong>Saturación</strong></button>
                <div class="panelAccordion">
                    <div class="row">
                        <div class="col-4">
                            <br>
                            <p>
                                El nivel de oxígeno en la sangre es la cantidad de oxígeno que circula en la sangre. La mayor parte del oxígeno es transportado por los glóbulos rojos, los cuales recolectan oxígeno de los pulmones y lo envían a todas las partes del cuerpo.

                            </p>
                        </div>
                        <div class="col-4">
                            <br>
                            <div class="alert-primary">
                                <p>
                                    Para la saturación de oxígeno, su porcentaje debe estar entre <strong>95 y 100%</strong>
                                </p>

                            </div>
                            <p>
                                Los valores por debajo del 90 por ciento se consideran bajos <strong>(hipoxemia)</strong> e indican la necesidad de oxígeno suplementario. Sus síntomas incluyen dificultad respiratoria severa, aumento de la frecuencia cardíaca
                                y dolor torácico.
                            </p>

                        </div>
                        <div class="col-4">
                            <br>
                            <iframe width="350" height="250" src="https://www.youtube.com/embed/B75kBvjJink" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                        </div>
                    </div>

                    <sup>https://www.outspot.es/es/Pulsioxmetro-para-la-frecuencia-cardaca-y-saturacin-de-oxgeno#:~:text=Para%20la%20saturaci%C3%B3n%20de%20ox%C3%ADgeno,card%C3%ADaca%20despu%C3%A9s%20de%20hacer%20ejercicio.</sup>
                    <sup>https://ma.com.pe/que-es-un-oximetro-de-pulso-y-como-interpretar-sus-valores</sup>
                </div>
                <br>
                <button id="accordionThree" class="accordion"><strong>Temperatura corporal y ambiental</strong></button>
                <div class="panelAccordion">
                    <div class="row">
                        <div class="col-4">
                            <br>
                            <p>
                                Se refiere al grado de calor o de frío, expresados en término de una escala específica. La temperatura corporal representa un equilibrio entre el calor producido por el cuerpo y su pérdida. Cuando la producción de calor es equivalente a la pérdida de
                                temperatura corporal, ésta última se mantiene constante en condiciones normales.
                            </p>

                        </div>
                        <div class="col-4">
                            <br>
                            <div class="alert-primary">
                                El control de la temperatura del cuerpo está regulada en el hipotálamo, que mantiene constante la temperatura central. La temperatura normal media de un paciente adulto está entre <strong>36.7 y 37ºC.</strong>
                            </div>
                            <strong>Hipertermia:</strong> Incremento importante de la temperatura corporal (más de 39ºC). <br>
                            <strong>Hipotermia:</strong> Temperatura corporal menor de la normal (menos de 36ºC).

                        </div>
                        <div class="col-4">
                            <br>
                            <iframe width="350" height="250" src="https://www.youtube.com/embed/tMvXOdY_8dM?start=115" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                        </div>
                    </div>
                    <sup>https://www.pisa.com.mx/publicidad/portal/enfermeria/manual/4_1_1.htm#:~:text=Los%20signos%20vitales%20son%20par%C3%A1metros,evoluci%C3%B3n%2C%20ya%20sea%20positiva%20o</sup>
                </div>



            </div>
            <br>


            <footer class="bg-light text-center text-lg-start">
                <!-- Copyright -->
                <div class="text-center p-3" style="background-color: rgba(218, 220, 238, 0.322);">
                    © 2020 Copyright:
                    <a class="text-dark" href="#">Leonardo Gonzalez Gutierrez</a>
                </div>
                <!-- Copyright -->
            </footer>
        </div>


    </div>



    <script src="./dev/JS/lib/chart.js/dist/Chart.min.js"></script>


    <script src="./dev/JS/lib/HighChart/highcharts.js"></script>
    <script src="./dev/JS/lib/HighChart/highcharts-more.js"></script>
    <script src="./dev/JS/lib/HighChart/exporting.js"></script>

    <!--
        
<script src="https://code.highcharts.com/highcharts.js"></script>
    <script src="https://code.highcharts.com/highcharts-more.js"></script>
    <script src="https://code.highcharts.com/modules/exporting.js"></script>
      
    -->

    <script src="./dev/JS/lib/HighChart/solid-gauge.js"></script>
    <script src="./dev/JS/lib/HighChart/export-data.js"></script>
    <script src="./dev/JS/lib/HighChart/accessibility.js"></script>


    <!--
          <script src="https://code.highcharts.com/modules/solid-gauge.js"></script>
    <script src="https://code.highcharts.com/modules/export-data.js"></script>
    <script src="https://code.highcharts.com/modules/accessibility.js"></script>
       
    -->


    <script>
        $(document).ready(function() {


            accordionShow();

            function accordionShow() {

                var acc = document.getElementsByClassName("accordion");
                var i;

                for (i = 0; i < acc.length; i++) {
                    acc[i].addEventListener("click", function() {
                        this.classList.toggle("activeAccordion");
                        var panelAccordion = this.nextElementSibling;
                        if (panelAccordion.style.maxHeight) {
                            panelAccordion.style.maxHeight = null;
                        } else {
                            panelAccordion.style.maxHeight = panelAccordion.scrollHeight + "px";
                        }
                    });
                }
            }





            var btnAbrirPopup = document.getElementById('btn-abrir-popup'),
                overlay = document.getElementById('overlay'),
                popup = document.getElementById('popup'),
                btnCerrarPopup = document.getElementById('btn-cerrar-popup');

            var btnAbrirPopup2 = document.getElementById('btn-abrir-popup-2');
            var btnAbrirPopup3 = document.getElementById('btn-abrir-popup-3');

            var sectionHeart = document.getElementById('dataHeartRate');
            var sectionOxygen = document.getElementById('dataOxygen');
            var sectionTemperature = document.getElementById('dataTemperature');

            var btnAbrirApp = document.getElementById('goDevice');
            var sectionDevice = document.getElementById('deviceConected');
            var sectionHome = document.getElementById('home');


            var btnCerrarApp = document.getElementById('offDevice');
            var sectionHead = document.getElementById('appRun');


            btnCerrarApp.addEventListener('click', function() {

                let opc = confirm("Deseas desconectarse del dispositivo?");
                if (opc) {
                    sectionHome.classList.remove('d-block');
                    sectionHome.classList.add('d-none');
                    sectionHead.classList.add('d-none');

                    let container = document.getElementById('containerPageEnd');
                    container.classList.remove('d-none');
                    container.classList.add('d-block');

                    setTimeout(function() {
                        location.reload();
                    }, 5000);
                }
            });

            btnAbrirApp.addEventListener('click', function() {

                let inputCod = $('#codDevice').val();
                //DEV01
                if (inputCod == 'DEV01') {
                    let container = document.getElementById('containerPage');
                    container.classList.remove('d-none');
                    container.classList.add('d-block');

                    setTimeout(function() {
                        container.classList.remove('d-block');
                        container.classList.add('d-none');

                        sectionDevice.classList.remove('d-none');
                        sectionDevice.classList.add('d-block');

                        alert('Nos hemos conectado con el dispositivo. Bienvenido!');
                        // document.body.style.overflowY = "visible"; // despueés de cargar le devolvemos el scroll
                    }, 5000);


                    sectionHome.classList.remove('d-block');
                    sectionHome.classList.add('d-none');

                } else {
                    alert('No encontramos el dispositivo');
                }

            });


            btnAbrirPopup.addEventListener('click', function() {
                overlay.classList.add('active');
                popup.classList.add('active');

                sectionHeart.classList.remove('d-none');
                sectionHeart.classList.add('d-block');

                sectionOxygen.classList.remove('d-none');
                sectionOxygen.classList.add('d-none');

                sectionTemperature.classList.remove('d-none');
                sectionTemperature.classList.add('d-none');

            });
            btnAbrirPopup2.addEventListener('click', function() {
                overlay.classList.add('active');
                popup.classList.add('active');

                sectionHeart.classList.remove('d-none');
                sectionHeart.classList.add('d-none');

                sectionOxygen.classList.remove('d-none');
                sectionOxygen.classList.add('d-block');

                sectionTemperature.classList.remove('d-none');
                sectionTemperature.classList.add('d-none');

            });

            btnAbrirPopup3.addEventListener('click', function() {
                overlay.classList.add('active');
                popup.classList.add('active');

                sectionHeart.classList.remove('d-none');
                sectionHeart.classList.add('d-none');

                sectionOxygen.classList.remove('d-none');
                sectionOxygen.classList.add('d-none');

                sectionTemperature.classList.remove('d-none');
                sectionTemperature.classList.add('d-block');
            });



            btnCerrarPopup.addEventListener('click', function(e) {
                e.preventDefault();
                overlay.classList.remove('active');
                popup.classList.remove('active');
            });



            ////---------------------------
            function showTime() {
                var date = new Date();
                var h = date.getHours(); // 0 - 23
                var m = date.getMinutes(); // 0 - 59
                var s = date.getSeconds(); // 0 - 59
                var session = "AM";

                if (h == 0) {
                    h = 12;
                }

                if (h > 12) {
                    h = h - 12;
                    session = "PM";
                }

                h = (h < 10) ? "0" + h : h;
                m = (m < 10) ? "0" + m : m;
                s = (s < 10) ? "0" + s : s;

                var time = h + ":" + m + ":" + s + " " + session;
                document.getElementById("MyClockDisplay").innerText = time;
                document.getElementById("MyClockDisplay").textContent = time;
                setTimeout(showTime, 1000);

            }
            showTime();
            /*------------------------------------------------------------------------------------*/

            var enlace = jQuery('.ubicar');
            var longitud = jQuery('.longitud');
            var latitud = jQuery('.latitud');
            var mensaje = jQuery('.mensaje');

            if (navigator.geolocation) {
                enlace.click(function(e) {
                    e.preventDefault();
                    mensaje.html("Cargando...");
                    navigator.geolocation.getCurrentPosition(insertarUbicacion, errorUbicacion);
                });
            } else {
                alert('Lo sentimos, tu navegador no soporta geolocation');
            }

            function insertarUbicacion(posicion) {
                // Obtenemos las propiedades de geolocation y las guardamos en las variables
                var glatitud = posicion.coords.latitude;
                var glongitud = posicion.coords.longitude;

                // Insertar el mapa de google en un iframe
                jQuery('#mapa').html('<iframe width="300" height="200" frameborder="0" scrolling="no" marginheight="0" marginwidth="0" src="http://maps.google.co.uk/?ie=UTF8&amp;ll=' + glatitud + ',' + glongitud + '&amp;spn=0.332359,0.617294&amp;t=m&amp;z=11&amp;output=embed"></iframe>');

                longitud.html('Longitud: ' + glongitud);
                latitud.html('Latitud: ' + glatitud);

                //Hacemos una llamada ajax a la API de Google Maps para obtener el mapa de la ubicación
                jQuery.ajax({
                    url: 'http://maps.googleapis.com/maps/api/geocode/json?latlng=' + glatitud + ',' + glongitud + '&sensor=true',
                    type: 'POST',
                    dataType: 'json',
                    error: function(xhr, textStatus, errorThrown) {
                        errorUbicacion();
                    }
                });

            }

            function errorUbicacion() {
                alert('No pudimos encontrar tu ubicación exacta');
            }


        });
    </script>



    <!--Se necesita conexión a Internet-->
    <script src="./dev/JS/lib/HighChart/chart.min.js"></script>
    <!--
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.2.1/dist/chart.min.js" integrity="sha256-uVEHWRIr846/vAdLJeybWxjPNStREzOlqLMXjW/Saeo=" crossorigin="anonymous"></script>    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js" charset="utf-8"></script>
-->
    <script src="./dev/JS/lib/soocket/socket.io.js"></script>

    <script type="text/javascript">
        $(document).ready(function() {

            const socket = io();

            function escapeRegExp(string) {
                return string.replace(/[*+?^${}()|[\]\\]/g, '');
            }
            //------------------------------------ CHART.JS
            var ctx = document.getElementById('myCanvas').getContext('2d');
            var ctx02 = document.getElementById('canvas02').getContext('2d');
            var ctx03 = document.getElementById('canvas03').getContext('2d');


            //heart Rate
            var config = {
                type: 'line',
                data: {
                    labels: [],
                    datasets: [{
                        label: 'Heart Rate',
                        backgroundColor: "#FF3333",
                        borderColor: "#FF3333",
                        data: [],
                        fill: false,
                        radius: 0.5,

                    }]
                },
                options: {
                    responsive: true,
                    title: {
                        display: true,
                        text: 'Sensor MAX30100 PulseOximeter'
                    },
                    tooltips: {
                        mode: 'index',
                        intersect: false,
                    },
                    hover: {
                        mode: 'nearest',
                        intersect: true
                    },
                    scales: {
                        y: {
                            max: 130,
                            min: 10,
                            ticks: {
                                stepSize: 0.5
                            }

                        }

                    }
                }
            };
            //Oxigeno
            var configOxygen = {
                type: 'line',
                data: {
                    labels: [],
                    datasets: [{
                        label: 'bpm / SpO2',
                        backgroundColor: "#0831FC",
                        borderColor: "#0831FC",
                        data: [],
                        fill: false,
                        radius: 0.5,

                    }]
                },
                options: {
                    responsive: true,
                    title: {
                        display: true,
                        text: 'Sensor MAX30100 PulseOximeter'
                    },
                    tooltips: {
                        mode: 'index',
                        intersect: false,
                    },
                    hover: {
                        mode: 'nearest',
                        intersect: true
                    },
                    scales: {
                        y: {
                            max: 110,
                            min: 80,
                            ticks: {
                                stepSize: 0.5
                            }
                        }

                    }
                }
            };





            //Temperature
            var configTemp = {
                type: 'line',
                data: {
                    labels: [],
                    datasets: [{
                        label: 'Ambient Temp °C',
                        backgroundColor: "#8D08FC",
                        borderColor: "#8D08FC",
                        data: [],
                        fill: false,
                        radius: 0.5,

                    }, {
                        label: 'Person Temp °C',
                        backgroundColor: "#FCA308",
                        borderColor: "#FCA308",
                        data: [],
                        fill: false,
                        radius: 0.5,

                    }]
                },
                options: {
                    responsive: true,
                    title: {
                        display: true,
                        text: 'Sensor MLX90614 Temperature'
                    },
                    tooltips: {
                        mode: 'index',
                        intersect: false,
                    },
                    hover: {
                        mode: 'nearest',
                        intersect: true
                    },
                    scales: {

                        y: {
                            max: 70, //<<<<<<<<<<<<<---------------CAMBIAR
                            min: 0,
                            ticks: {
                                stepSize: 0.5
                            }
                        }
                    }
                }
            };


            let counter = 0;

            myLine = new Chart(ctx, config);
            myLine2 = new Chart(ctx02, configOxygen);
            myLine3 = new Chart(ctx03, configTemp);

            // <h1 id="showDataRitmoCard">81 <small>bpm</small> </h1>
            var dataCardio = document.getElementById('showDataRitmoCard');

            // <h1 id="showDataSaturacion">98% <small>SpO2</small> </h1>
            var dataSaturacion = document.getElementById('showDataSaturacion');

            socket.on('arduino:data', function(dataSerial) {
                let info = dataSerial.value.toString();
                let clear = escapeRegExp(info).replace('rn', '').replace('"', '').replace('"', '');
                let dataArduino = clear.split(',');
                //[heartRate, oxygen, tempAmbC, tempObjC]
                //console.log(dataArduino);
                // console.log(parseFloat(dataArduino[0]) + 1);

                let heartRate = parseFloat(dataArduino[0]);
                let oxygen = parseFloat(dataArduino[1]);
                let tempAmbC = parseFloat(dataArduino[2]);
                let tempObjC = parseFloat(dataArduino[3]);

                //RitmoCardiaco
                setHeartRate(heartRate);
                setHearOxygen(oxygen);
                setTempAmbC(tempAmbC);
                setTempObjC(tempObjC);

                dataCardio.innerHTML = '' + heartRate + '&nbsp;<small>bpm</small>';
                dataSaturacion.innerHTML = '' + oxygen + '&nbsp;<small>SpO2</small>';

                myLine.data.labels.push(counter);
                myLine.data.datasets[0].data.push(heartRate);
                myLine.update();

                //Oxigeno
                myLine2.data.labels.push(counter);
                myLine2.data.datasets[0].data.push(oxygen);
                myLine2.update();

                //Temperatura Corporal y Ambiental
                myLine3.data.labels.push(counter);
                myLine3.data.datasets[0].data.push(tempAmbC);
                myLine3.data.datasets[1].data.push(tempObjC);

                myLine3.update();

                point = chartSpeed.series[0].points[0];
                point.update(getTempAmbC());

                point = chartRpm.series[0].points[0];
                point.update(getTempObjC());

                counter++;

            });



            var appOk = document.getElementById('appRun');
            var navDev = document.getElementById('navbarDev');
            var infoSectionOne = document.getElementById('accordionOne');
            var infoSectionTwo = document.getElementById('accordionTwo');
            var infoSectionThree = document.getElementById('accordionThree');

            socket.on('arduino:close', function(dataSerial) {

                if (dataSerial) {

                    appOk.classList.remove('alert-primary');
                    appOk.classList.add('alert-danger');

                    navDev.classList.remove('bg-primary');
                    navDev.classList.add('bg-danger');

                    infoSectionOne.style.backgroundColor = '#FF0000';
                    infoSectionTwo.style.backgroundColor = '#FF0000';
                    infoSectionThree.style.backgroundColor = '#FF0000';

                    alert('Se ha perdido la conexión con el dispositivo :(');

                }
            });


            var dataVelHearRate = 0;
            var dataVelOxygen = 0;

            var dataTempAmbC = 0;
            var dataTempObjC = 0;

            function setHeartRate(data) {
                dataVelHearRate = data;
            }

            function getHeartRate() {
                return dataVelHearRate;
            }

            function setHearOxygen(data) {
                dataVelOxygen = data;
            }

            function getHeartOxygen() {
                return dataVelOxygen;
            }

            function setTempAmbC(data) {
                dataTempAmbC = data;
            }

            function getTempAmbC() {
                return dataTempAmbC;
            }

            function setTempObjC(data) {
                dataTempObjC = data;
            }

            function getTempObjC() {
                return dataTempObjC;
            }


            Highcharts.chart('container', {

                    chart: {
                        type: 'gauge',
                        plotBackgroundColor: null,
                        plotBackgroundImage: null,
                        plotBorderWidth: 0,
                        plotShadow: false
                    },

                    title: {
                        text: 'Velocimentro/Ritmo cardiaco'
                    },

                    pane: {
                        startAngle: -150,
                        endAngle: 150,
                        background: [{
                            backgroundColor: {
                                linearGradient: {
                                    x1: 0,
                                    y1: 0,
                                    x2: 0,
                                    y2: 1
                                },
                                stops: [
                                    [0, '#FFF'],
                                    [1, '#333']
                                ]
                            },
                            borderWidth: 0,
                            outerRadius: '109%'
                        }, {
                            backgroundColor: {
                                linearGradient: {
                                    x1: 0,
                                    y1: 0,
                                    x2: 0,
                                    y2: 1
                                },
                                stops: [
                                    [0, '#333'],
                                    [1, '#FFF']
                                ]
                            },
                            borderWidth: 1,
                            outerRadius: '107%'
                        }, {
                            // default background
                        }, {
                            backgroundColor: '#DDD',
                            borderWidth: 0,
                            outerRadius: '105%',
                            innerRadius: '103%'
                        }]
                    },

                    // the value axis
                    yAxis: {
                        min: 30,
                        max: 110,

                        minorTickInterval: 'auto',
                        minorTickWidth: 1,
                        minorTickLength: 10,
                        minorTickPosition: 'inside',
                        minorTickColor: '#666',

                        tickPixelInterval: 30,
                        tickWidth: 2,
                        tickPosition: 'inside',
                        tickLength: 10,
                        tickColor: '#666',
                        labels: {
                            step: 2,
                            rotation: 'auto'
                        },
                        title: {
                            text: ''
                        },
                        plotBands: [{
                            from: 30,
                            to: 79,
                            color: '#DF5353' // red

                        }, {
                            from: 90,
                            to: 110,
                            color: '#DDDF0D' // yellow
                        }, {
                            from: 80,
                            to: 90,
                            color: '#55BF3B' // greencolor: '#55BF3B' // red
                        }]
                    },

                    series: [{
                        name: 'bpm',
                        data: [0],
                        tooltip: {
                            valueSuffix: ''
                        }
                    }]

                },

                // Add some life
                function(chart) {
                    if (!chart.renderer.forExport) {
                        setInterval(function() {
                            var point = chart.series[0].points[0],
                                inc = Math.round((Math.random() - 0.5) * 20);
                            point.update(getHeartRate());

                            //  console.log(getHeartRate());
                        }, 100);
                    }
                }
            );





            //Velocimetro oxigeno
            Highcharts.chart('containerOxigeno', {

                    chart: {
                        type: 'gauge',
                        plotBackgroundColor: null,
                        plotBackgroundImage: null,
                        plotBorderWidth: 0,
                        plotShadow: false
                    },

                    title: {
                        text: 'Velocimentro/Oxigeno'
                    },

                    pane: {
                        startAngle: -150,
                        endAngle: 150,
                        background: [{
                            backgroundColor: {
                                linearGradient: {
                                    x1: 0,
                                    y1: 0,
                                    x2: 0,
                                    y2: 1
                                },
                                stops: [
                                    [0, '#FFF'],
                                    [1, '#333']
                                ]
                            },
                            borderWidth: 0,
                            outerRadius: '109%'
                        }, {
                            backgroundColor: {
                                linearGradient: {
                                    x1: 0,
                                    y1: 0,
                                    x2: 0,
                                    y2: 1
                                },
                                stops: [
                                    [0, '#333'],
                                    [1, '#FFF']
                                ]
                            },
                            borderWidth: 1,
                            outerRadius: '107%'
                        }, {
                            // default background
                        }, {
                            backgroundColor: '#DDD',
                            borderWidth: 0,
                            outerRadius: '105%',
                            innerRadius: '103%'
                        }]
                    },

                    // the value axis
                    yAxis: {
                        min: 0,
                        max: 120,

                        minorTickInterval: 'auto',
                        minorTickWidth: 1,
                        minorTickLength: 10,
                        minorTickPosition: 'inside',
                        minorTickColor: '#666',

                        tickPixelInterval: 30,
                        tickWidth: 2,
                        tickPosition: 'inside',
                        tickLength: 10,
                        tickColor: '#666',
                        labels: {
                            step: 2,
                            rotation: 'auto'
                        },
                        title: {
                            text: ''
                        },
                        plotBands: [{
                            from: 101,
                            to: 120,
                            color: '#DF5353' // red

                        }, {
                            from: 0,
                            to: 90,
                            color: '#DDDF0D' // yellow
                        }, {
                            from: 90,
                            to: 100,
                            color: '#55BF3B' // greencolor: '#55BF3B' // red
                        }]
                    },

                    series: [{
                        name: 'SpO2',
                        data: [0],
                        tooltip: {
                            valueSuffix: ''
                        }
                    }]

                },

                // Add some life
                function(chart) {
                    if (!chart.renderer.forExport) {
                        setInterval(function() {
                            var point = chart.series[0].points[0],
                                inc = Math.round((Math.random() - 0.5) * 20);
                            point.update(getHeartOxygen());
                        }, 100);
                    }
                });



        });

        //---------------------------------------Vekocimetro/RitmoCardiaco


        //----Velocimetro temperatura
        var gaugeOptions = {
            chart: {
                type: 'solidgauge'
            },

            title: null,

            pane: {
                center: ['50%', '85%'],
                size: '140%',
                startAngle: -90,
                endAngle: 90,
                background: {
                    backgroundColor: Highcharts.defaultOptions.legend.backgroundColor || '#EEE',
                    innerRadius: '60%',
                    outerRadius: '100%',
                    shape: 'arc'
                }
            },

            exporting: {
                enabled: false
            },

            tooltip: {
                enabled: false
            },

            // the value axis
            yAxis: {
                stops: [
                    [0.1, '#55BF3B'], // green
                    [0.5, '#DDDF0D'], // yellow
                    [0.9, '#DF5353'] // red
                ],
                lineWidth: 0,
                tickWidth: 0,
                minorTickInterval: null,
                tickAmount: 2,
                title: {
                    y: -70
                },
                labels: {
                    y: 16
                }
            },

            plotOptions: {
                solidgauge: {
                    dataLabels: {
                        y: 5,
                        borderWidth: 0,
                        useHTML: true
                    }
                }
            }
        };

        // The speed gauge
        var chartSpeed = Highcharts.chart('container-speed', Highcharts.merge(gaugeOptions, {
            yAxis: {
                min: -10,
                max: 80,
                title: {
                    text: 'Temperatura ambiental'
                }
            },

            credits: {
                enabled: false
            },

            series: [{
                name: 'Speed',
                data: [27],
                dataLabels: {
                    format: '<div style="text-align:center">' +
                        '<span style="font-size:25px">{y}</span><br/>' +
                        '<span style="font-size:12px;opacity:0.4">°C</span>' +
                        '</div>'
                },
                tooltip: {
                    valueSuffix: ''
                }
            }]

        }));

        // The RPM gauge
        var chartRpm = Highcharts.chart('container-rpm', Highcharts.merge(gaugeOptions, {
            yAxis: {
                min: 0,
                max: 70,
                title: {
                    text: 'Temperatura corporal'
                }
            },

            series: [{
                name: 'RPM',
                data: [37],
                dataLabels: {
                    format: '<div style="text-align:center">' +
                        '<span style="font-size:25px">{y:.1f}</span><br/>' +
                        '<span style="font-size:12px;opacity:0.4">' +
                        '°C' +
                        '</span>' +
                        '</div>'
                },
                tooltip: {
                    valueSuffix: ''
                }
            }]

        }));
    </script>

</body>

</html>

</html>